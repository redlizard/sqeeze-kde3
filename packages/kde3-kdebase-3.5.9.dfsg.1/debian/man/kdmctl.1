.\" This file was generated by (a slightly modified) kdemangen.pl and edited by hand
.TH KDMCTL 1 "June 2006" "K Desktop Environment" "KDM remote control application"
.SH NAME
kdmctl
\- kdm remote control application
.SH SYNOPSIS
\fBkdmctl\fP [options] [command [command arguments]]
.SH DESCRIPTION
\fBkdmctl\fP is an application to remote\-control \fBkdm\fP. It makes use of UNIX domain sockets.
.sp 1
There are two types of sockets: the global one (dmctl) and the per\-display ones (dmctl\-<display>). The global one's subdir is owned by root, the subdirs of the per\-display ones' are owned by the user currently owning the session (root or the logged in user).
.sp 1
The directory in which the sockets are located is determined this way:
.RS 3
\- the \fB\-s\fP option is examined
.br
\- the $DM_CONTROL variable is examined
.br
\- the kdm config file is searched for the FifoDir key
.br
.RI \- /var/run/xdmctl \ and\  /var/run \ are\ tried
.RE
.sp 1
If $DISPLAY is set (or \fB\-d\fP was specified) and \fB\-g\fP was not specified, the
display\-specific control socket will be used, otherwise the global one.
.sp 1
Tokens in the command and the reply are tab\-separated.
Command arguments can be specified as separate command line parameters,
in which case they are simply concatenated with tabs in between.
.sp 1
If the command is '\-', \fBkdmctl\fP reads commands from stdin.
The default command is 'caps'.
.SH OPTIONS
.SS
.SS Options:
.TP
.B \-h \-help
print help message.
.TP
.B \-g \-global
Use global control socket even if $DISPLAY is set
.TP
.B \-d \-display
Override $DISPLAY
.TP
.B \-s \-sockets
Override $DM_CONTROL
.TP
.B \-c \-config
Use alternative kdm config file
.SS Commands:
.br
.SS Global commands:
.TP 
.B login
display (now|schedule) user password [session_arguments]
.br
 login user at specified display. if "now" is specified, a possibly running session is killed, otherwise the login is done after the session exits.
.br
session_arguments are printf\-like escaped contents for \fI.dmrc\fP. Unlisted keys will default to previously saved values.
.SS Per\-display commands:
.TP 
.B lock
The display is marked as locked. If the X\-Server crashes in this state, no auto\-relogin will be performed even if the option is on.
.TP 
.B unlock
Reverse the effect of "lock": re\-enable auto\-relogin.
.TP 
.B suicide
The currently running session is forcibly terminated. No auto\-relogin is attempted, but a scheduled "login" command will be executed.
.SS Commands for all sockets:
.TP
.B caps
Returns a list of this socket's capabilities:
.IP "    \- kdm"
identifies kdm, in case some other DM implements this protocol, too.
.IP "    \- list, activate, lock, suicide, login"
the respective command is supported.
.IP "    \- bootoptions"
the "listbootoptions" command and the "=" option to "shutdown" are supported.
.IP "    \- shutdown <list>"
"shutdown" is supported and allowed to the listed users (comma\-separated). "*" means all authenticated users.
.IP "    \- shutdown"
"shutdown" is supported and allowed to everybody.
.IP "    \- nuke <list>"
forced shutdown is allowed to the listed users.
.IP "    \- nuke"
forced shutdown is allowed to everybody.
.IP "    \- reserve <number>"
reserve displays are configured and <number> are available at this time.
.TP 
\fBlist\fP [all|alllocal]
.br
Return a list of running sessions. By default all active sessions are listed. If "all" is specified, passive sessions are listed as well. If "alllocal" is specified, passive sessions are listed as well, but all incoming remote sessions are skipped.
.sp 1
Each session entry is a comma\-separated tuple of:
.RS 7
\- Display or TTY name
.br
\- VT name for local sessions
.br
\- Logged in user's name, empty for passive sessions and outgoing
.br
  remote sessions (local chooser mode)
.br
\- Session type or remote host for outgoing remote sessions,
.br
  empty for passive sessions
.br
\- A flag field:
.RS 5
\- "t" for tty sessions
.br
\- "*" for the display belonging to the requesting socket
.br
\- "!" for sessions that cannot be killed by the requesting
.br
  socket
.br
\- New flags might be added later
.br
.RE
\- New fields might be added later
.RE
.TP
\fBreserve\fP [timeout in seconds]
.br
Start a reserve login screen. If nobody logs in within the specified amount of time (one minute by default), the display is removed again. When the session on the display exits, the display is removed, too.
.br
Permitted only on sockets of local displays and the global socket.
.TP
\fBactivate\fP (vt|display)
.br
Switch to a particular VT (virtual terminal). The VT may be specified either directly (e.g., vt3) or by a display using it (e.g., :2).
.br
Permitted only on sockets of local displays and the global socket.
.TP
.B listbootoptions
List available boot options.
.br
=> "ok" list default current default and current are indices into the list and are \-1 if unset or undeterminable.
.TP
\fBshutdown\fP (reboot|halt) [=bootchoice]
.br
  (ask|trynow|forcenow|schedule|start
.br
   (\-1|end (force|forcemy|cancel)))
.br
.RS 7
Request a system shutdown, either a reboot or a halt/poweroff.
.sp 1
An OS choice for the next boot may be specified from the list returned by "listbootoptions".
.sp 1
Shutdowns requested from per\-display sockets are executed when the current session on that display exits. Such a request may pop up a dialog asking for confirmation and/or authentication.
.sp 1
start is the time for which the shutdown is scheduled. If it starts with a plus\-sign, the current time is added. Zero means immediately.
.sp 1
end is the latest time at which the shutdown should be performed if active sessions are still running. If it starts with a plus\-sign, the start time is added. Minus one means wait infinitely. If end is through and active sessions are still running, \fBKDM\fP can do one of the following:
.RS 3
- "cancel" \- give up the shutdown.
.br
- "force" \- shut down nonetheless.
.br
- "forcemy" \- shut down nonetheless if all active sessions
.br
   belong to the requesting user. Only for per\-display sockets.
.RE
.sp 1
start and end are specified in seconds since the UNIX epoch.
.sp 1
"trynow" is a synonym for "0 0 cancel", "forcenow" for "0 0 force" and "schedule" for "0 \-1".
.sp 1
"ask" attempts an immediate shutdown and interacts with the user if active sessions are still running. Only for per\-display sockets.
.RE
.TP
\fBshutdown cancel\fP [local|global]
.br
Cancel a scheduled shutdown. The global socket always cancels the currently pending shutdown, while per\-display sockets default to cancelling their queued request.
.TP
\fBshutdown status\fP
Return a list with information about shutdowns.
.br
The entries are comma\-separated tuples of:
.RS 10
\- ("global"|"local") \- pending vs. queued shutdown. A local
.br
  entry can be returned only by a per\-display socket.
.br
\- ("halt"|"reboot")
.br
\- start
.br
\- end
.br
\- ("ask"|"force"|"forcemy"|"cancel")
.br
\- Numeric user ID of the requesting user, \-1 for the global
.br
  socket.
.br
\- The next boot OS choice or "\-" for none.
.br
\- New fields might be added later.
.RE
.SH SEE ALSO
.BR kdm (1)
.TP
.I /usr/share/doc/kdm/README.gz
Information about the command sockets (and \fBkdm\fP)
.SH AUTHORS
.nf
Oswald Buddenhagen <ossi@kde.org>

.br
.fi
Please use http://bugs.kde.org to report bugs; do not mail the authors directly.
.PP
This manual page was written by Holger Hartmann <Holger_Hartmann@gmx.de> for the Debian Project (but may be used by others). Permission is granted to copy, distribute and/or modify this document under the terms of the GNU General Public License, Version 2 or any later version published by the Free Software Foundation.
.PP
On Debian systems, the complete text of the GNU General Public License can be found in /usr/share/common\-licenses/GPL.
